select COUNT(*) 
from green_taxi_201909
WHERE CAST( lpep_pickup_datetime AS DATE) ='2019-09-18'
AND CAST( lpep_dropoff_datetime AS DATE) ='2019-09-18';


select CAST( lpep_pickup_datetime AS DATE) as pickup_date,
trip_distance
from green_taxi_201909
order by trip_distance desc;


select  
	z."Borough" , 
	sum(total_amount)
from green_taxi_201909 t
join zones z 
	on t."PULocationID" = z."LocationID"
where CAST( lpep_pickup_datetime AS DATE) ='2019-09-18'
	and z."Borough" not in ('Unknown')
group by 1
	having sum(total_amount) > 50000;
	
	
	
	
select  
zd."Zone", tip_amount
from green_taxi_201909 t
join zones zp
	on t."PULocationID" = zp."LocationID"
join zones zd
on t."DOLocationID" = zd."LocationID"
where  zp."Zone"  in ('Astoria')
order by tip_amount desc
;